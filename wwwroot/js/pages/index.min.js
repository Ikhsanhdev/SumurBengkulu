moment.locale("id");let map,awlrMarkers=[],arrMarkers=[];function initMap(){var e={lat:-3.1004,lng:102.2655};function t(e,t){fetch(e).then(e=>e.json()).then(e=>{e.features.forEach(e=>{e.properties||(e.properties={}),e.properties.fillColor=t}),map.data.addGeoJson(e)})}map=new google.maps.Map(document.getElementById("map"),{zoom:8,center:e,gestureHandling:"greedy",mapTypeId:google.maps.MapTypeId.HYBRID,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_LEFT},mapId:"YOUR_MAP_ID",styles:[{featureType:"administrative.locality",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"on"}]}]}),t("/data/006_DAS_Bengkulu.json","red"),t("/data/005_WS_Nasal-Padang_Guci.json","blue"),t("/data/004_WS_Bengkulu-Alas-Talo.json","yellow"),t("/data/003_WS_Sebelat-Ketahun-Lais.json","red"),t("/data/002_WS_Teramang-Muar.json","orange"),t("/data/001_WS_Silaut-Tarusan.json","green"),map.data.setStyle(function(e){return{fillColor:e.getProperty("fillColor")||"gray",fillOpacity:.3,strokeColor:"white",strokeWeight:.7}}),map.data.addListener("click",function(e){var t=e.feature.getProperty("name");new google.maps.InfoWindow({content:`<strong>${t}</strong>`,position:e.latLng}).open(map)});(new google.maps.Geocoder).geocode({location:e},(t,e)=>{if("OK"===e&&t[0]){let e="";for(var a of t[0].address_components)if(a.types.includes("administrative_area_level_1")){e=a.long_name;break}new google.maps.InfoWindow({content:`<strong>${e}</strong>`}).open(map)}});e=document.createElement("div");e.innerHTML=`
        <div style="background: white; padding: 10px; font-size: 13px; border: 1px solid #ccc; border-radius: 5px; line-height: 20px; min-width:160px;">
            <div style="display:flex; align-items:center; margin-bottom:5px;">
                <input type="checkbox" id="chk-duga" checked style="margin-right:6px;">
                <div style="width:16px; height:16px; background:blue; margin-right:6px; border-radius:3px;"></div>
                <label for="chk-duga" style="cursor:pointer;">Pos Duga Air</label>
            </div>
            <div style="display:flex; align-items:center;">
                <input type="checkbox" id="chk-curah" checked style="margin-right:6px;">
                <div style="width:16px; height:16px; background:green; margin-right:6px; border-radius:50%;"></div>
                <label for="chk-curah" style="cursor:pointer;">Pos Curah Hujan</label>
            </div>
        </div>`,e.addEventListener("change",function(e){"chk-duga"===e.target.id?toggleMarkers("awlr",e.target.checked):"chk-curah"===e.target.id&&toggleMarkers("arr",e.target.checked)}),e.style.margin="10px",map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(e)}function toggleMarkers(e,t){let a=[];"awlr"===e?a=awlrMarkers:"arr"===e&&(a=arrMarkers),console.log(`Toggling ${e} markers: ${t?"show":"hide"}, total markers: `+a.length),a.forEach(e=>{e.map=t?map:null})}function loadAwlrLastReading(){[{lat:-3.79082652717697,lng:102.36347289412156,name:"AWLR BENGKULU HILIR",deviceId:"HGT741",das:"DAS BENGKULU",reading_at:"1 September 2025 11:45 WIB",water_level:1.01,slug:"awlr-bengkulu-hilir"},{lat:-2.6242039234005485,lng:101.29243288189173,name:"AWLR AIR DIKIT",deviceId:"HGT753",das:"DAS DIKIT",reading_at:"1 September 2025 11:45 WIB",water_level:1.33,slug:"awlr-air-dikit"},{lat:-3.781495,lng:102.282005,name:"AWLR AIR BENGKULU (EWS)",deviceId:"HGT859",das:"DAS BENGKULU",reading_at:"1 September 2025 11:45 WIB",water_level:1.62,slug:"awlr-tanjung-jaya-(ews)"},{lat:-3.761304231675983,lng:102.42001103431923,name:"AWLR BENGKULU HULU",deviceId:"HGT729",das:"DAS BENGKULU",reading_at:"1 September 2025 11:45 WIB",water_level:.47,slug:"awlr-bengkulu-hulu"}].forEach((e,t)=>{let a=new google.maps.InfoWindow({maxWidth:400,minWidth:280});var l=`
            <div class="table-responsive">
                <table class="table mb-2 font-12">
                    <tbody>
                        <tr>
                            <td class="px-0 py-2 pt-1 pe-3" colspan="3">
                                <div class="d-flex align-items-start">
                                    <img class="me-2 rounded-3" src="/assets/images/logo-pu.png" width="35" height="35" alt="${e.name}">
                                    <div class="w-100">
                                        <h5 class="mt-0 mb-1 fw-bold font-12" style="color: #2A62A6;">${e.name}</h5>
                                        <div class="d-flex align-items-center">
                                            <span><small class="mdi mdi-circle text-success"></small> Online</span>
                                            <span class="badge badge-outline-secondary rounded-1 ms-1">${e.deviceId}</span>
                                        <div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="py-1 px-0">Sungai</td>
                            <td class="py-1 px-2">:</td>
                            <td class="py-1 px-0">${e.das}</td>
                        </tr>
                        <tr>
                            <td class="py-1 px-0">Update</td>
                            <td class="py-1 px-2">:</td>
                            <td class="py-1 px-0">${e.reading_at}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="d-flex justify-content-around align-items-center mb-1 reading-text">
                <div class="col-4 text-center font-14 fw-bold text-dark">
                    ${e.water_level} <sup>m</sup>
                </div>
                <div class="col-4 text-center font-14 fw-bold text-dark">
                    - 
                </div>
                <div class="col-4 text-center font-15 fw-bold text-dark">
                    <span class="badge bg-success font-10">NORMAL</span>
                </div>
            </div>
            <div class="d-flex justify-content-around reading-text mb-2">
                <div class="col-4 text-center font-12 text-nowrap">
                    TMA
                </div>
                <div class="col-4 text-center font-12 text-nowrap">
                    Debit
                </div>
                <div class="col-4 text-center font-12 text-nowrap">
                    Status
                </div>
            </div>
            <a href="https://hkasumatera7.higertech.com/Station/Detail/${e.slug}" target="_blank" class="btn btn-sm btn-primary rounded-pill waves-effect waves-light text-white w-100">Lihat Detail</a>`,s=document.createElement("div");s.className="awlr-marker";let n=new google.maps.marker.AdvancedMarkerElement({map:map,position:{lat:e.lat,lng:e.lng},content:s});awlrMarkers.push(n),n.addListener("gmp-click",()=>{a&&a.close(),a.setContent(l),a.open({anchor:n,map:map})})})}function loadArrLastReading(){[{lat:-2.8905,lng:101.455,name:"ARR SIDODADI",deviceId:"HGT111",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"ARR-SIDODADI"},{lat:-4.368153,lng:103.065737,name:"ARR SUKA MAJU",deviceId:"HGT173",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"ARR-SUKA-MAJU"},{lat:-2.6275,lng:101.2869,name:"ARR SARI BULAN",deviceId:"HGT109",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"ARR-SARI-BULAN"},{lat:-2.744394,lng:101.341934,name:"ARR NENGGALO",deviceId:"HGT818",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"arr-nenggalo-2"},{lat:-3.703222,lng:102.489222,name:"ARR BAJAK",deviceId:"HGT172",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"ARR-BAJAK"},{lat:-3.785731565927591,lng:102.29108836501837,name:"ARR TANJUNG JAYA",deviceId:"HGT746",reading_at:"1 September 2025 11:25 WIB",ch:0,slug:"arr-tanjung-jaya"}].forEach((e,t)=>{let a=new google.maps.InfoWindow({maxWidth:400,minWidth:280});var l=`
            <div class="table-responsive">
                <table class="table mb-2 font-12">
                    <tbody>
                        <tr>
                            <td class="px-0 py-2 pt-1" colspan="3">
                                <div class="d-flex align-items-start">
                                    <img class="me-2 rounded-3" src="/assets/images/logo-pu.png" width="35" height="35" alt="${e.name}">
                                    <div class="w-100">
                                        <h5 class="mt-0 mb-1 fw-bold font-12" style="color: #2A62A6;">${e.name}</h5>
                                        <div class="d-flex align-items-center">
                                            <span><small class="mdi mdi-circle text-success"></small> Online</span>
                                            <span class="badge badge-outline-secondary rounded-1 ms-1">${e.deviceId}</span>
                                        <div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="py-1 px-0">Update</td>
                            <td class="py-1 px-2">:</td>
                            <td class="py-1 px-0">${e.reading_at}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="d-flex justify-content-around align-items-center reading-text">
                <div class="col-6 text-center font-15 fw-bold text-dark">
                    0 <sup>mm</sup>
                </div>
                <div class="col-6 text-center font-15 fw-bold text-dark">
                    <img src="/assets/images/arr/berawan.png" alt="Tidak Ada Hujan" class="avatar-xs">
                </div>
            </div>
            <div class="d-flex justify-content-around reading-text mb-3">
                <div class="col-6 text-center font-12 text-nowrap">
                    Curah Hujan
                </div>
                <div class="col-6 text-center font-12 text-nowrap">
                    Tidak Ada Hujan
                </div>
            </div>
            <a href="https://hkasumatera7.higertech.com/Station/Detail/${e.slug}" target="_blank" class="btn btn-sm btn-primary rounded-pill waves-effect waves-light text-white w-100">Lihat Detail</a>`,s=document.createElement("div");s.className="arr-marker";let n=new google.maps.marker.AdvancedMarkerElement({map:map,position:{lat:e.lat,lng:e.lng},content:s});arrMarkers.push(n),n.addListener("gmp-click",()=>{a&&a.close(),a.setContent(l),a.open({anchor:n,map:map})})})}$(document).ready(function(){loadAwlrLastReading(),loadArrLastReading()});